<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MCF: Deep Space Mission</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        #canvas-container { width: 100vw; height: 100vh; display: block; }
        
        /* UI Overlay */
        #ui-layer {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none; /* Let clicks pass through to 3D scene */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 40px;
        }

        h1 {
            font-family: 'Arial', sans-serif;
            font-weight: 900;
            font-size: 5rem;
            color: white;
            text-transform: uppercase;
            letter-spacing: 10px;
            margin: 0;
            text-shadow: 0 0 30px rgba(255, 100, 50, 0.8);
            pointer-events: auto;
        }

        .hud-text {
            font-family: 'Courier New', monospace;
            color: #00ffcc;
            font-size: 14px;
            text-shadow: 0 0 5px #00ffcc;
        }

        /* Loading Screen */
        #loader {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            color: white; font-family: monospace; font-size: 24px;
            transition: opacity 1s ease-out;
        }
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div id="loader">INITIALIZING SYSTEMS...</div>

    <!-- 3D Canvas -->
    <div id="canvas-container"></div>

    <!-- HTML UI Overlay -->
    <div id="ui-layer">
        <div class="hud-text">SYS: ONLINE // ORBIT: STABLE // MCF-PROTOCOLS: ACTIVE</div>
        <div>
            <h1>My CRM Fix</h1>
            <p style="color: #aaa; font-family: sans-serif; font-size: 1.2rem; max-width: 600px; margin-top: 10px; pointer-events: auto;">
                Next-Gen Customer Relationship Management Repair.
                <br><br>
                <button style="padding: 15px 40px; background: #ff4500; color: white; border: none; font-size: 18px; font-weight: bold; cursor: pointer; border-radius: 5px;">
                    INITIATE LAUNCH
                </button>
            </p>
        </div>
        <div class="hud-text" style="text-align: right;">COORDINATES: 45.912, -12.004</div>
    </div>

    <!-- Import Map for Three.js (No installation needed) -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { RGBELoader } from 'three/addons/loaders/RGBELoader.js';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        // --- SCENE SETUP ---
        const scene = new THREE.Scene();
        // Fog for depth (fades distant objects to black)
        scene.fog = new THREE.FogExp2(0x000000, 0.002);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 5);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.toneMapping = THREE.ReinhardToneMapping;
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // --- POST PROCESSING (BLOOM) ---
        const renderScene = new RenderPass(scene, camera);
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0;
        bloomPass.strength = 1.2; // Glow intensity
        bloomPass.radius = 0.5;

        const composer = new EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);

        // --- LIGHTING ---
        const ambientLight = new THREE.AmbientLight(0x404040, 2); // Soft white light
        scene.add(ambientLight);

        const sunLight = new THREE.PointLight(0xffaa00, 3, 100);
        sunLight.position.set(10, 10, 10);
        scene.add(sunLight);

        // --- STARS (PARTICLE SYSTEM) ---
        const starsGeometry = new THREE.BufferGeometry();
        const starsCount = 5000;
        const posArray = new Float32Array(starsCount * 3);

        for(let i = 0; i < starsCount * 3; i++) {
            // Spread stars far out
            posArray[i] = (Math.random() - 0.5) * 200; 
        }

        starsGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const starsMaterial = new THREE.PointsMaterial({
            size: 0.05,
            color: 0xffffff,
            transparent: true,
            opacity: 0.8,
        });
        const starMesh = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(starMesh);

        // --- ASTEROIDS (INSTANCED MESH) ---
        // Efficiently render 1000 asteroids
        const asteroidGeometry = new THREE.IcosahedronGeometry(0.2, 0);
        const asteroidMaterial = new THREE.MeshStandardMaterial({ 
            color: 0x888888, 
            roughness: 0.8,
            flatShading: true 
        });
        const asteroids = new THREE.InstancedMesh(asteroidGeometry, asteroidMaterial, 1000);
        
        const dummy = new THREE.Object3D();
        for (let i = 0; i < 1000; i++) {
            dummy.position.set(
                (Math.random() - 0.5) * 50,
                (Math.random() - 0.5) * 50,
                (Math.random() - 0.5) * 50
            );
            dummy.rotation.set(Math.random() * Math.PI, Math.random() * Math.PI, 0);
            const scale = Math.random() * 0.5 + 0.1;
            dummy.scale.set(scale, scale, scale);
            dummy.updateMatrix();
            asteroids.setMatrixAt(i, dummy.matrix);
        }
        scene.add(asteroids);

        // --- LION ASTRONAUT MODEL ---
        let lionModel;
        
        // NOTE: Since I cannot upload a file to your server, I am creating a placeholder
        // 3D Geometry to represent the Lion. 
        // REPLACE this section with: loader.load('path/to/lion.glb', ...)
        
        const group = new THREE.Group();
        
        // Helmet (Glass Sphere)
        const helmetGeo = new THREE.SphereGeometry(1, 32, 32);
        const helmetMat = new THREE.MeshPhysicalMaterial({
            color: 0x88ccff,
            metalness: 0.9,
            roughness: 0.1,
            transparent: true,
            opacity: 0.3,
            transmission: 0.9 // Glass effect
        });
        const helmet = new THREE.Mesh(helmetGeo, helmetMat);
        group.add(helmet);

        // Head (Orange Sphere)
        const headGeo = new THREE.SphereGeometry(0.7, 32, 32);
        const headMat = new THREE.MeshStandardMaterial({ color: 0xffa500 });
        const head = new THREE.Mesh(headGeo, headMat);
        group.add(head);

        // Suit Body (White Box)
        const bodyGeo = new THREE.BoxGeometry(1.2, 1.5, 0.8);
        const bodyMat = new THREE.MeshStandardMaterial({ color: 0xeeeeee });
        const body = new THREE.Mesh(bodyGeo, bodyMat);
        body.position.y = -1.2;
        group.add(body);

        // Jetpack Fire (Point Light + Mesh)
        const fireGeo = new THREE.ConeGeometry(0.2, 0.8, 8);
        const fireMat = new THREE.MeshBasicMaterial({ color: 0xff4400 });
        const fire = new THREE.Mesh(fireGeo, fireMat);
        fire.rotation.x = Math.PI;
        fire.position.set(0, -2.2, 0.4);
        group.add(fire);

        scene.add(group);
        lionModel = group;


        // --- INTERACTION: MOUSE MOVE ---
        let mouseX = 0;
        let mouseY = 0;
        let targetX = 0;
        let targetY = 0;

        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        document.addEventListener('mousemove', (event) => {
            mouseX = (event.clientX - windowHalfX);
            mouseY = (event.clientY - windowHalfY);
        });

        // Hide Loader
        setTimeout(() => {
            const loader = document.getElementById('loader');
            loader.style.opacity = '0';
            setTimeout(() => loader.remove(), 1000);
        }, 1500);

        // --- ANIMATION LOOP ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);

            const elapsedTime = clock.getElapsedTime();

            // Rotate Stars
            starMesh.rotation.y += 0.0005;

            // Rotate Asteroids
            asteroids.rotation.x += 0.0002;
            asteroids.rotation.y += 0.0005;

            // Float Lion
            if(lionModel) {
                lionModel.position.y = Math.sin(elapsedTime) * 0.1;
                lionModel.rotation.y += 0.005;
                
                // Parallax Effect (Lion follows mouse slightly)
                targetX = mouseX * 0.001;
                targetY = mouseY * 0.001;
                
                lionModel.rotation.x += 0.05 * (targetY - lionModel.rotation.x);
                lionModel.rotation.y += 0.05 * (targetX - lionModel.rotation.y);
            }

            // Flicker Jetpack
            fire.scale.y = (Math.random() * 0.5) + 0.8;

            // Render with Bloom
            composer.render();
        }

        animate();

        // Handle Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
